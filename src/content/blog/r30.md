---
author: Enguang Shi
pubDatetime: 2024-11-29T23:42:02Z
modDatetime:
title: "[React] 30. Forwarding Refs to Custom Components"
featured: false
draft: false
tags:
  - React
description: "A guide to forwarding refs to custom components in React for better control of DOM elements."
---

This section explains how to use `forwardRef` in React to forward refs to custom components. This is useful when you need to control a DOM element inside a child component from its parent.

## 目录

## Forwarding Refs to Custom Components

### 1. Why Forward Refs?

In React, refs are typically used to interact directly with DOM elements. Sometimes, you need to access a DOM element within a child component from the parent. Forwarding refs allows you to pass a ref from a parent component to a child component and connect it to a specific DOM element.

### 2. Example: Using `forwardRef` for a Dialog Component

Here’s an example where we use a modal (dialog) component and want to control its visibility from the parent component using a ref.

#### Parent Component (TimerChallenge)

```jsx
import { useRef } from "react";
import ResultModal from "./ResultModal";

export default function TimerChallenge() {
  const dialogRef = useRef(); // Create a ref for the modal

  function handleShowModal() {
    dialogRef.current.showModal(); // Show the dialog programmatically
  }

  return (
    <>
      <ResultModal ref={dialogRef} result="lost" />
      <button onClick={handleShowModal}>Show Modal</button>
    </>
  );
}
```

#### Child Component (ResultModal)

```jsx
import { forwardRef } from "react";

const ResultModal = forwardRef(function ResultModal({ result }, ref) {
  return (
    <dialog ref={ref} className="result-modal">
      <h2>You {result}</h2>
      <form method="dialog">
        <button>Close</button>
      </form>
    </dialog>
  );
});

export default ResultModal;
```

### 3. Key Steps in Forwarding Refs

1. **Create a Ref in the Parent**:

   - Use `useRef` in the parent to create a ref that will be passed to the child component.

   ```jsx
   const dialogRef = useRef();
   ```

2. **Use `forwardRef` in the Child**:

   - Wrap the child component function with `forwardRef` to allow it to accept a ref from the parent.

   ```jsx
   const ResultModal = forwardRef(function ResultModal(props, ref) {
     return <dialog ref={ref}>{/* Content here */}</dialog>;
   });
   ```

3. **Pass the Ref to the Child**:

   - Use the `ref` prop in the parent to pass the ref to the child.

   ```jsx
   <ResultModal ref={dialogRef} />
   ```

4. **Access the Ref in the Parent**:

   - Use `ref.current` to access the DOM element in the parent.

   ```jsx
   dialogRef.current.showModal();
   ```

### 4. Benefits of Using `forwardRef`

- **Control from Parent**: Allows the parent component to directly control the child’s DOM element.
- **Reusable Components**: Makes custom components more reusable by exposing their internal DOM structure when needed.

### 5. When to Use `forwardRef`

- **Custom Input Components**: Forward refs to expose input elements for parent validation.
- **Dialogs or Modals**: Control visibility and behavior of modals programmatically.
- **Third-Party Libraries**: Interact with third-party libraries that require direct DOM access.

### 6. Conclusion

Forwarding refs is a powerful tool for creating flexible, reusable components while maintaining control over their internal DOM elements. It’s especially useful for scenarios like modals, custom inputs, or other components requiring programmatic DOM manipulation.
